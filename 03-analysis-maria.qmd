---
title: "Analysis"
---

Goals of this notebook: 

- What do these numbers show us about what kinds of crimes are being committed? How many are drug crimes?
- Who is being arrested?
- Who is doing the arresting?
- What kind of drugs? Is it fentanyl like Abbott says? Are most of the people getting arrested for human smuggling black? What does the data show and why might that be?
- Are a lot of people getting arrested in a specific backyard or area?
- Are most of the people arrested U.S. citizens? **

## Loading up libraries 

```{r}
#| label: setup
#| message: false


library(tidyverse)
library(janitor)
library(dplyr)
```


## Importing clean combined data, VERSA and SPURS 

```{r}
ols_data <- read_rds("data-processed/02-combine.rds")

ols_data
```

## What do these numbers show us about what kinds of crimes are being committed? How many are drug crimes?


Let's look at the amount of different charges under the charge category: 

```{r}
ols_data$charge |> unique()
```

I want to create different categories for all the charges in the dataset.    


```{r}
cat_ols <- ols_data |> 
  mutate(charge_cat = case_when(
    str_detect(charge, "Firearm|FIREARM|gun|GUN|Amm|Arm|Weapon|WEAPON") ~ "Weapon",
    str_detect(charge, "Poss|Drug|Mari|POSS|DRUG|MARI|Marj|MARJ|Man|Subs|Stash") ~ "Drug",
    str_detect(charge, "Smugg|SMUGG|Trafficking|TRAFFICKING|Trans|Bringing In") ~ "Smuggling/Trafficking of Persons",
    str_detect(charge, "Launder|LAUNDER") ~ "Money Laundering",
    str_detect(charge, "Trespass|TRESPASS") ~ "Trespassing",
    str_detect(charge, "Alien|ALIEN|Visa|VISA|IMMIGRATION|Immigration") ~ "Immigration Other",
    str_detect(charge, "Evad|EVAD|Flee|FLEE") ~ "Evasion/Fleeing",
    str_detect(charge, "Organized|Enterprise") ~ "Organized Crime",
    str_detect(charge, "Tamp|TAMP") ~ "Tampering",
    str_detect(charge, "Unauth") ~ "Unauthorized Use of Vehicle",
    str_detect(charge, "Warrant|WARRANT|Conspiracy|CONSPIRACY") ~ "Warrant/Conspiracy"),

    
    
    default. = NA
  )
  
 cat_ols |> 
   count(charge_cat, charge)
```

NOTE: 

- Drug category includes manufacturing and possession of drugs as well as stash house and drug related charges   
- Weapons category can include drug/weapon offenses that are unclear
- Warrant/Conspiracy is for more general charges 
- Weapons can include charges for smuggling persons and firearms 


Let's count per category to determine how many of these are drug crimes: 


```{r}
cat_ols |>  
  group_by(charge_cat) |> 
  summarise(appearances = n()) |> 
  arrange(desc(appearances))
```
 
