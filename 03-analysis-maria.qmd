---
title: "Analysis"
---

Goals of this notebook: 

- What do these numbers show us about what kinds of crimes are being committed? How many are drug crimes?
- Who is being arrested?
- Who is doing the arresting?
- What kind of drugs? Is it fentanyl like Abbott says? Are most of the people getting arrested for human smuggling Black? What does the data show and why might that be? **
- Are a lot of people getting arrested in a specific backyard or area?
- Are most of the people arrested U.S. citizens? **

## Loading up libraries 

```{r}
#| label: setup
#| message: false


library(tidyverse)
library(janitor)
library(dplyr)
```


## Importing clean combined data, VERSA and SPURS 

```{r}
ols_data <- read_rds("data-processed/02-combine.rds")

ols_data
```

## What do these numbers show us about what kinds of crimes are being committed? How many are drug crimes?


Let's look at the amount of different charges under the charge category: 

```{r}
ols_data$charge |> unique()
```

I want to create different categories for all the charges in the dataset.    


```{r}
cat_ols <- ols_data |> 
  mutate(charge_cat = case_when(
    str_detect(charge, "Firearm|FIREARM|gun|GUN|Amm|Arm|Weapon|WEAPON") ~ "Weapon",
    str_detect(charge, "Poss|Drug|Mari|POSS|DRUG|MARI|Marj|MARJ|Man|Subs|Stash") ~ "Drug",
    str_detect(charge, "Smugg|SMUGG|Trafficking|TRAFFICKING|Trans|Bringing In") ~ "Smuggling/Trafficking of Persons",
    str_detect(charge, "Launder|LAUNDER") ~ "Money Laundering",
    str_detect(charge, "Trespass|TRESPASS") ~ "Trespassing",
    str_detect(charge, "Alien|ALIEN|Visa|VISA|IMMIGRATION|Immigration") ~ "Immigration Other",
    str_detect(charge, "Evad|EVAD|Flee|FLEE") ~ "Evasion/Fleeing",
    str_detect(charge, "Organized|Enterprise") ~ "Organized Crime",
    str_detect(charge, "Tamp|TAMP") ~ "Tampering",
    str_detect(charge, "Unauth") ~ "Unauthorized Use of Vehicle",
    str_detect(charge, "Warrant|WARRANT|Conspiracy|CONSPIRACY") ~ "Warrant/Conspiracy"),

    
    
    default. = NA
  )
  
 cat_ols |> 
   count(charge_cat, charge)
```

NOTE: 

- Drug category includes manufacturing and possession of drugs as well as stash house and drug related charges   
- Weapons category can include drug/weapon offenses that are unclear
- Warrant/Conspiracy is for more general charges 
- Weapons can include charges for smuggling persons and firearms 


Let's count per category to determine how many of these are drug crimes: 


```{r}
cat_ols |>  
  group_by(charge_cat) |> 
  summarise(appearances = n()) |> 
  arrange(desc(appearances))
```
 
 Data Takeaway: At least 22,847 charges under Operation Lone Star are drug-related. 
 
## What kind of drugs? Is it fentanyl like Abbott says? 

Let's look at the drug charge category and break it down by type of drug. We used drug statute codes from Texas (https://statutes.capitol.texas.gov/Docs/HS/htm/HS.481.htm) and the Drug Enforcement Agency (https://www.dea.gov/drug-information/drug-scheduling.) 

```{r}
drug_ols <- cat_ols |>
  group_by(charge) |>
  filter(charge_cat == "Drug") |>
  mutate(
    drug_type = case_when(
      str_detect(charge, "Mari|MARI|Marj|MARJ") ~ "Marijuana",
      str_detect(charge, "Fent|FENT|1-B") ~ "Fentanyl",
      str_detect(charge, "Cocaine|COCAINE") ~ "Cocaine",
      str_detect(charge, "Meth|METH") ~ "Crystal Meth",
      str_detect(charge, "1a|1-A|LSD")  ~ "LSD",
      str_detect(charge, "Heroin|HEROIN") ~ "Heroin"),
   
     default. = NA
  )  
  
    drug_ols |>
    count(drug_type)

  
  

```


 
 Key: 
 - Poss Cs Pg = Possession of Controlled Substance in Penalty Group 
 - Fentanyl is group 1-B (any type of fentanyl)
 - Drug schedules can refer to drugs like other drugs (for example, fentanyl can be found in schedule II drugs)
 - 1-A LSD as well as any of its salts, isomers, and salts of isomers.
 
 ** count by drug_type 
 
 



## Are most of the people getting arrested for human smuggling Black? What does the data show and why might that be?

To answer this question, lets look at the smuggling/trafficking charges and look at the offenders by race. 


```{r}
smuggle_ols <- cat_ols |>
  group_by(person_race_abbr,charge_cat) |>
  summarise(appearances = n()) |> 
  arrange(desc(appearances)) |>
  filter(charge_cat == "Smuggling/Trafficking of Persons") |>
  select(!charge_cat)

smuggle_ols
```
Key: 
- B = Black 
- H = Hispanic (if race not given, only ethnicity)
- W = White 
- A = American Indian or Alaska Native 
- U = Unknown 

Data Takeaways: 

- Most people arrested for smuggling/trafficking aren't Black. Although, 1,133 of those charged with smuggling/trafficking people under Opertion Lone Star are Black. 
- Of those charged, the most common ethnicity (without taking into consideration race) is Hispanic, with 8,081 charges. 




 
